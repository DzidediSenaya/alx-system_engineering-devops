#!/usr/bin/env bash

# Check if running in Docker (optional, you may skip this if not needed)
if grep -q 'docker' /proc/1/cgroup; then
  echo "Running in Docker, proceeding with configuration..."
else
  echo "Not running in Docker. Exiting..."
  exit 1
fi

# Backup the original hosts file
sudo cp /etc/hosts /etc/hosts.backup

# Check if localhost entry exists in the hosts file
if grep -qE '^[[:space:]]*127\.0\.0\.2[[:space:]]+localhost[[:space:]]*$' /etc/hosts; then
  echo "localhost entry already exists in /etc/hosts. No need to change."
else
  # Add localhost entry to the hosts file
  echo "127.0.0.2 localhost" | sudo tee -a /etc/hosts
fi

# Modify the facebook.com entry to set the desired resolution
sudo sed -i 's/^31\.13\.66\.35[[:space:]]\+facebook\.com[[:space:]]*$/8.8.8.8 facebook.com/' /etc/hosts

echo "Configuration completed successfully."
